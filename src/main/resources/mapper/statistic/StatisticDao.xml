<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xjtu.dbc.robserver.manage.statistic.dao.StatisticDao">
    <select id="getUserTotalCount" resultType="java.lang.Integer">
        select count(userid)count_total from user u where   u.roleid = 1001 UNION
        select count(userid) from user u where u.roleid = 1002 UNION
        select count(historyid) from history where historytype = 701
    </select>

    <select id="getUserSexAgeReport" resultType="com.xjtu.dbc.robserver.manage.statistic.entity.UserSexAgeReport">
        select
        count(case when usersex=101 then 1 else null end) manNum,
        count(case when usersex=100 then 1 else null end) womanNum,
        count(case when  (YEAR(CURDATE())-YEAR(userbirth)) >0 and (YEAR(CURDATE())-YEAR(userbirth)) &lt;=18 then 1 else null end) ageOne,
        count(case when  (YEAR(CURDATE())-YEAR(userbirth)) >18 and (YEAR(CURDATE())-YEAR(userbirth)) &lt;=25 then 1 else null end) ageTwo,
        count(case when  (YEAR(CURDATE())-YEAR(userbirth)) >25 and (YEAR(CURDATE())-YEAR(userbirth)) &lt;=35 then 1 else null end) ageThree,
        count(case when  (YEAR(CURDATE())-YEAR(userbirth)) >35 and (YEAR(CURDATE())-YEAR(userbirth)) &lt;=50 then 1 else null end) ageFour,
        count(case when  (YEAR(CURDATE())-YEAR(userbirth)) >50 then 1 else null end) ageFive
        from user;

    </select>
</mapper>
